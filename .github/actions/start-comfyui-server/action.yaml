name: Start Hanzo Studio Server
description: 'Start Hanzo Studio server in a container environment (assumes Hanzo Studio is pre-installed)'

inputs:
  front_end_root:
    description: 'Path to frontend dist directory'
    required: false
    default: '$GITHUB_WORKSPACE/dist'
  timeout:
    description: 'Timeout in seconds for server startup'
    required: false
    default: '600'

runs:
  using: 'composite'
  steps:
    - name: Copy devtools and start server
      shell: bash
      run: |
        set -euo pipefail
        cp -r ./tools/devtools/* /Hanzo Studio/custom_nodes/HanzoStudio_devtools/
        cd /Hanzo Studio && python3 main.py --cpu --multi-user --front-end-root "${{ inputs.front_end_root }}" &
        wait-for-it --service 127.0.0.1:8188 -t ${{ inputs.timeout }}
